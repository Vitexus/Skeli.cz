<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Skeli – Eliptický video přehrávač</title>
  <style>
    :root{ --bg:#0b0c0d; --panel:#121416; --text:#e7e9ea; --accent:#00d1ff; --border:rgba(255,255,255,.15); }
    *{box-sizing:border-box}
    body{ margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Arial, sans-serif; background:var(--bg); color:var(--text); }
    .wrap{ max-width:1100px; margin:24px auto 32px; padding:0 16px; }
    h1{ font-weight:700; letter-spacing:.5px; margin:0 0 10px; }

    /* Main player */
    .player{ position:relative; border:1px solid var(--border); border-radius:14px; background:var(--panel); overflow:hidden; box-shadow:0 20px 50px rgba(0,0,0,.35); }
    .player .stage{ position:relative; padding-top:56.25%; }
    .player iframe,.player video{ position:absolute; inset:0; width:100%; height:100%; border:0; display:block; }
    .fade{ animation:fade .35s ease both; }
    @keyframes fade{ from{opacity:0} to{opacity:1} }

    /* Elliptic carousel */
    .carousel{ position:relative; height:190px; margin-top:16px; user-select:none; }
    .track{ position:absolute; inset:0; perspective:1000px; }
    .thumb{ position:absolute; top:50%; left:50%; width:240px; height:135px; margin:-67.5px 0 0 -120px; border-radius:12px; overflow:hidden; box-shadow:0 12px 30px rgba(0,0,0,.35); border:1px solid var(--border); background:#000; transform-origin:center center; transition:transform .32s ease, opacity .32s ease, filter .32s ease; cursor:pointer; }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
    .thumb .label{ position:absolute; left:8px; right:8px; bottom:6px; font-size:13px; background:linear-gradient(transparent, rgba(0,0,0,.7)); padding:36px 6px 6px; color:#fff; text-shadow:0 1px 2px rgba(0,0,0,.5); border-radius:10px; }
    .thumb.active{ outline:2px solid var(--accent); filter:saturate(1.1) contrast(1.05); }

    .nav{ position:absolute; inset:0; display:flex; align-items:center; justify-content:space-between; pointer-events:none; }
    .nav button{ pointer-events:auto; background:rgba(255,255,255,.08); color:#fff; border:1px solid var(--border); border-radius:50%; width:40px; height:40px; display:grid; place-items:center; cursor:pointer; backdrop-filter:blur(3px); }

    /* Responsive tweaks */
    @media (max-width:720px){ .thumb{ width:190px; height:107px; margin:-53.5px 0 0 -95px; } }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Eliptický video přehrávač</h1>
    <div class="player" id="player">
      <div class="stage">
        <iframe id="frame" src="" allow="autoplay; encrypted-media; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>

    <div class="carousel" id="carousel">
      <div class="track" id="track"></div>
      <div class="nav">
        <button id="prev" aria-label="Předchozí">◀</button>
        <button id="next" aria-label="Další">▶</button>
      </div>
    </div>
  </div>

  <script>
    // Demo data (YouTube). V produkci napojte na DB / server.
    const videos = [
      { id:'Skeli_TikTak', yt:'K6dB6Zs2w_0', title:'Skeli – Tik Tak (feat. Taida & Cheorchina)' },
      { id:'Skeli_Chillujem', yt:'3bV13mK0fS8', title:'Skeli – Chillujem' },
      { id:'Skeli_Prototyp', yt:'eUTfYN9eQJA', title:'Skeli – Prototyp' },
      { id:'Skeli_Squad', yt:'0wyYpv25O7Y', title:'Skeli – Squad' },
      { id:'Skeli_Solo', yt:'AUkQ0bWwVkg', title:'Skeli – Solo' },
    ];

    // Main player helpers
    const frame = document.getElementById('frame');
    function play(v){
      const url = `https://www.youtube.com/embed/${v.yt}?autoplay=1`;
      frame.classList.remove('fade'); void frame.offsetWidth; // restart animace
      frame.src = url; frame.classList.add('fade');
      try{ localStorage.setItem('gp_id', v.yt); localStorage.setItem('gp_title', v.title); }catch(e){}
      // volitelně synchronizuj se sticky přehrávačem na webu (pokud existuje):
      if (window.parent && window.parent.playVideo) window.parent.playVideo(v.yt, v.title);
    }

    // Elliptic layout
    const track = document.getElementById('track');
    let current = 0; let thumbs = [];

    function renderThumbs(){
      track.innerHTML = '';
      thumbs = videos.map((v, i)=>{
        const el = document.createElement('div');
        el.className = 'thumb';
        el.innerHTML = `<img src="https://img.youtube.com/vi/${v.yt}/hqdefault.jpg" alt="${v.title}"><div class="label">${v.title}</div>`;
        el.addEventListener('click', ()=>{ current = i; layout(); play(v); });
        track.appendChild(el);
        return el;
      });
      layout();
      play(videos[current]);
    }

    function layout(){
      const N = videos.length, R1 = 360, R2 = 36; // poloměry elipsy
      thumbs.forEach((el, i)=>{
        const t = ((i - current + N) % N); // 0..N-1 relativně k current
        let k = t; if (k > N/2) k = k - N; // posun do rozsahu -N/2..N/2
        const ang = (k/(N/2)) * Math.PI/2; // -PI/2..PI/2 (střed = 0)
        const x = Math.cos(ang) * R1;      // eliptická projekce X
        const y = Math.sin(ang) * R2;      // eliptická projekce Y
        const s = 0.55 + 0.45 * Math.cos(ang); // měřítko (střed největší)
        const z = Math.cos(ang);           // pro z-index
        el.style.transform = `translate3d(${x}px, ${y}px, 0) scale(${s})`;
        el.style.opacity = 0.35 + 0.65*Math.pow(s,1.5);
        el.style.zIndex = (1000 + Math.round(z*100)).toString();
        el.classList.toggle('active', k===0);
      });
    }

    // Drag & buttons
    let startX = 0, dragging = false;
    track.addEventListener('pointerdown', e=>{ dragging=true; startX=e.clientX; track.setPointerCapture(e.pointerId); });
    track.addEventListener('pointerup',   e=>{ dragging=false; track.releasePointerCapture(e.pointerId); });
    track.addEventListener('pointercancel', ()=> dragging=false);
    track.addEventListener('pointermove', e=>{
      if(!dragging) return; const dx = e.clientX - startX; if (Math.abs(dx) > 40){
        current = (current + (dx<0?1:videos.length-1)) % videos.length; startX = e.clientX; layout(); play(videos[current]);
      }
    });
    document.getElementById('prev').onclick = ()=>{ current = (current + videos.length - 1) % videos.length; layout(); play(videos[current]); };
    document.getElementById('next').onclick = ()=>{ current = (current + 1) % videos.length; layout(); play(videos[current]); };

    renderThumbs();
  </script>
</body>
</html>
